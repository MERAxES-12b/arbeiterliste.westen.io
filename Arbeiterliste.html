<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin — Arbeiterliste</title>
<link rel="website icon" type="png" href="images/lostmc-icon.png">
<style>
:root {
  --violett: #8b5cf6;
  --violett-dark: #6d28d9;
  --bg: #0d0d0d;
  --text: #f5f5f5;
  --active-bg: #1a1a1a;
  --inactive-bg: #2a2a2a;
  --hover-bg: #2e2e2e;
}
body {
  font-family: 'Inter', Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  margin: 0;
  padding: 0;
}
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 60px 20px 20px 20px;
  text-align: center;
}
.back-btn {
  position: fixed;
  top: 20px;
  left: 20px;
  background: rgba(40,40,40,0.8);
  color: #fff;
  border: 1px solid var(--violett);
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
  z-index: 1000;
}
.back-btn:hover {
  background: rgba(70,70,70,0.9);
  transform: translateY(-2px);
}
h1 { text-align: center; color: var(--violett); text-transform: uppercase; margin-bottom: 20px; }
button {
  cursor: pointer;
  margin: 5px;
  padding: 6px 12px;
  border: none;
  border-radius: 6px;
  transition: background 0.2s;
}
button:hover { opacity:0.9; }

table {
  margin: 20px auto;
  border-collapse: collapse;
  text-align: center;
  min-width: 900px;
}
th, td {
  padding: 12px 20px;
  border: 1px solid #2b2b2b;
  white-space: nowrap;
  vertical-align: middle;
}
th { background: #181818; color: var(--violett); }
tr.active { background: var(--active-bg); }
tr.inactive { background: var(--inactive-bg); opacity:0.6; }
tr:hover { background: var(--hover-bg); }

.switch { position: relative; display: inline-block; width: 50px; height: 24px; vertical-align: middle; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; transition: .4s; border-radius: 24px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 2px; bottom: 2px; background: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background: var(--violett); }
input:checked + .slider:before { transform: translateX(26px); }

.edit-btn { background: #ffcc00; color: #000; padding: 4px 8px; border: none; border-radius: 6px; cursor: pointer; margin-left:5px; }
.edit-btn:hover { background: #ffdd33; }
.delete-btn { background: #ff4d4d; color: white; padding: 4px 8px; border: none; border-radius: 6px; cursor: pointer; margin-left:5px; }
.delete-btn:hover { background: #ff6666; }

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  visibility: hidden;
  opacity: 0;
  transition: 0.3s;
  z-index: 1000;
}
.modal.active { visibility: visible; opacity: 1; }
.modal-content {
  background: #181818;
  padding: 20px;
  border-radius: 12px;
  width: 500px;
  color: var(--text);
  text-align: left;
}
.close {
  margin-top: 15px;
  background: rgba(40,40,40,0.8);
  border: 1px solid var(--violett);
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  color: white;
}
.close:hover { background: rgba(70,70,70,0.9); }

label { display: block; margin-top: 10px; font-weight: 500; }
input { width: 100%; padding: 10px; box-sizing: border-box; border-radius: 6px; border: 1px solid var(--violett); background: #1a1a1a; color: var(--text); font-size: 14px; }
</style>
</head>
<body>

<button class="back-btn" onclick="window.history.back()">← Zurück</button>

<div class="container">
<h1>Arbeiterliste</h1>
<button onclick="openForm()">Neuen Mitarbeiter hinzufügen</button>

<table id="employeeTable">
<thead>
<tr>
<th>Aktiv</th>
<th>Name</th>
<th>Telefon</th>
<th>Arbeitgeber</th>
<th>Eintritt</th>
<th>ID</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div id="modal" class="modal">
<div class="modal-content">
<h2>Mitarbeiter hinzufügen/bearbeiten</h2>
<label>Name: <input type="text" id="name"></label>
<label>Telefon: <input type="tel" id="tel"></label>
<label>Arbeitgeber: <input type="text" id="job"></label>
<label>Austritt: <input type="date" id="exit" style="display:none;"></label>
<label>ID: <input type="text" id="id"></label>
<label>Aktiv: <input type="checkbox" id="active"></label>
<button onclick="saveEmployee()">Speichern</button>
<button class="close" onclick="closeForm()">Abbrechen</button>
</div>
</div>

<script>
let employees = JSON.parse(localStorage.getItem('employees')||'[]');
let editIndex = null;

function saveData(){ 
  localStorage.setItem('employees', JSON.stringify(employees)); 
  renderTable(); 
}

function formatDate(dateStr){
  if(!dateStr) return '';
  const d = new Date(dateStr);
  const day = String(d.getDate()).padStart(2,'0');
  const month = String(d.getMonth()+1).padStart(2,'0');
  const year = d.getFullYear();
  return `${day}.${month}.${year}`;
}

function renderTable(){
  const tbody = document.querySelector("#employeeTable tbody");
  tbody.innerHTML = '';
  const sorted = employees.slice().sort((a,b)=> (a.active===b.active)?0:(a.active? -1:1));
  sorted.forEach((e)=>{
    const tr = document.createElement('tr');
    tr.classList.add(e.active ? 'active':'inactive');

    const actions = !e.active ? 
      `<button class="edit-btn" onclick="editEmployee(${employees.indexOf(e)})">Ändern</button>
       <button class="delete-btn" onclick="deleteEmployee(${employees.indexOf(e)})">Löschen</button>` 
      : '';

    tr.innerHTML = `
      <td><label class="switch"><input type="checkbox" ${e.active?"checked":""} onchange="toggleActive(${employees.indexOf(e)},this)"><span class="slider"></span></label>${actions}</td>
      <td>${e.name}</td>
      <td>${e.tel}</td>
      <td>${e.job}</td>
      <td>${formatDate(e.entry)}</td>
      <td>${e.id || ''}</td>
    `;
    tbody.appendChild(tr);
  });
}

function toggleActive(index, checkbox){
  employees[index].active = checkbox.checked;
  saveData();
}

function deleteEmployee(index){
  if(confirm("Mitarbeiter endgültig löschen?")){
    employees.splice(index,1);
    saveData();
  }
}

function editEmployee(index){
  editIndex = index;
  const e = employees[index];
  document.getElementById('name').value = e.name;
  document.getElementById('tel').value = e.tel;
  document.getElementById('job').value = e.job;
  document.getElementById('exit').style.display = 'block';
  document.getElementById('exit').value = e.exit;
  document.getElementById('id').value = e.id;
  document.getElementById('active').checked = e.active;
  openForm();
}

function openForm(){ document.getElementById('modal').classList.add('active'); }
function closeForm(){ 
  document.getElementById('modal').classList.remove('active'); 
  document.getElementById('exit').style.display = 'none';
}

function saveEmployee(){
  const today = new Date().toISOString().split('T')[0];
  const emp = {
    name: document.getElementById('name').value,
    tel: document.getElementById('tel').value,
    job: document.getElementById('job').value,
    entry: editIndex!==null ? employees[editIndex].entry : today,
    exit: document.getElementById('exit').value,
    id: document.getElementById('id').value,
    active: document.getElementById('active').checked
  };
  if(editIndex !== null){
    employees[editIndex] = emp;
    editIndex = null;
  } else {
    employees.push(emp);
  }
  saveData();
  closeForm();
  document.querySelectorAll('#modal input').forEach(el=>el.value='');
  document.getElementById('active').checked=false;
}

renderTable();
</script>
</body>
</html>

